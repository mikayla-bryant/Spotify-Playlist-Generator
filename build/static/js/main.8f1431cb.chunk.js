(this["webpackJsonpspotify-playlist-generator"]=this["webpackJsonpspotify-playlist-generator"]||[]).push([[0],{128:function(e,t,a){},252:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(22),c=a.n(n),l=(a(128),a(5)),i=a(267),o=a(53),s=Object(o.a)({root:{color:"#52af77"},thumb:{height:24,width:24,backgroundColor:"#fff",border:"2px solid currentColor",marginTop:-8,marginLeft:-12,"&:focus, &:hover, &$active":{boxShadow:"inherit"}},active:{},valueLabel:{left:"calc(-50% + 4px)"},track:{height:8,borderRadius:4},rail:{height:8,borderRadius:4}})(i.a),u=a(11),d=a(21),p=a(44),b=a(119),v=a(59),j=[{text:"Select a genre...",value:"",attributes:{disabled:!0,selected:!0}},{text:"<POP>",value:"POP",attributes:{disabled:!0}},{text:"Electropop",value:"electropop"},{text:"Hyperpop",value:"hyperpop"},{text:"Indie Pop",value:"indie+pop"},{text:"J-Pop",value:"japanese+pop"},{text:"K-Pop",value:"k-pop"},{text:"Pop",value:"Pop"},{text:"<HIP-HOP>",value:"HIP-HOP",attributes:{disabled:!0}},{text:"Rap",value:"rap"},{text:"Trap",value:"trap"},{text:"Grime",value:"grime"},{text:"<R&B>",value:"R&B",attributes:{disabled:!0}},{text:"Soul",value:"Soul"},{text:"Funk",value:"funk"},{text:"Indie Soul",value:"indie+soul"},{text:"Gospel",value:"gospel"},{text:"<ELECTRONIC>",value:"ELECTRONIC",attributes:{disabled:!0}},{text:"Electronic",value:"Electronic"},{text:"Electronica",value:"electronica"},{text:"Microhouse",value:"microhouse"},{text:"Wonky",value:"wonky"},{text:"Downtempo",value:"Downtempo"},{text:"Jazztronica",value:"jazztronica"},{text:"Techno",value:"Techno"},{text:"Dubstep",value:"Dubstep"},{text:"EDM",value:"EDM"},{text:"IDM",value:"IDM"},{text:"Tropical House",value:"tropical"},{text:"Chiptune",value:"Chiptune"},{text:"Synthwave",value:"synthwave"},{text:"<ALTERNATIVE>",value:"ALTERNATIVE",attributes:{disabled:!0}},{text:"Britpop",value:"Britpop"},{text:"Experimental",value:"experimental"},{text:"Vaporwave",value:"vaporwave"},{text:"Shoegaze",value:"shoegaze"},{text:"Chillwave",value:"Chillwave"},{text:"Popgaze",value:"popgaze"},{text:"Neo-psychedelic",value:"neo-psychedelic"},{text:"<ROCK>",value:"ROCK",attributes:{disabled:!0}},{text:"Rock",value:"rock"},{text:"Dance-punk",value:"dance-punk"},{text:"Alternative Metal",value:"alternative+metal"},{text:"Indie Rock",value:"indie+rock"},{text:"Grunge",value:"grunge"},{text:"Punk",value:"punk"},{text:"Emo",value:"Emo"},{text:"Art Rock",value:"art+rock"},{text:"Psychedelic Rock (Classic)",value:"psychedelic+rock"},{text:"Hard Rock",value:"hard+rock"},{text:"Garage Rock",value:"garage+rock"},{text:"Surf Rock",value:"surf+rock"},{text:"Math Rock",value:"math+rock"},{text:"Rockabilly",value:"rockabilly"},{text:"Metal",value:"metal"},{text:"<COUNTRY>",value:"COUNTRY",attributes:{disabled:!0}},{text:"Country",value:"country"},{text:"Folk",value:"folk"},{text:"Indie folk",value:"indie+folk"},{text:"Acoustic",value:"acoustic"},{text:"<JAZZ>",value:"JAZZ",attributes:{disabled:!0}},{text:"Jazz",value:"jazz"},{text:"Swing",value:"swing"},{text:"<WORLD>",value:"world",attributes:{disabled:!0}},{text:"Latin",value:"latin"},{text:"Brazilian",value:"brazilian"},{text:"Cumbia",value:"cumbia"},{text:"Flamenco",value:"flamenco"},{text:"Salsa",value:"salsa"},{text:"Reggae",value:"reggae"},{text:"Reggaeton",value:"reggaeton"},{text:"Bachata",value:"bachata"},{text:"African",value:"african"},{text:"Afropop",value:"afropop"},{text:"Celtic",value:"celtic"},{text:"Balkan",value:"balkan"},{text:"Devotional",value:"devotional"},{text:"<MISC>",value:"MISC",attributes:{disabled:!0}},{text:"Soundtrack",value:"soundtrack"},{text:"Classical",value:"classical"},{text:"Kids",value:"kids"}],h=a(32),x=h.b().shape({playlistName:h.c().required("Playlist name is required.").nullable(),description:h.c().nullable(),privacy:h.a().nullable(),genre:h.c().required("Genre is required").nullable(),numSongs:h.c().required("Number of songs is required.").nullable()}),O=a(54),y=a(10),f=a.n(y),g=a(15),m=a(7),k=a(16),S=a(31),R=a.n(S),E=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","1","2","3","4","5","6","7","8","9","0"],I="GET_URI",C="GET_USER_INFO",w="CREATE_PLAYLIST",A="SEARCH_SONGS",L="GET_TRACK_URIS",N="HANDLE_FORM_VALUES",T="HANDLE_SLIDER_VALUE",M="GET_PLAYLIST_URL",P="SUCCESS_ALERT",U="LOADING_START",z="ALERT_MESSAGE",G="LOADING_FINISH",D="SUCCESS_FINISH",_="ACCESS_CODE_SUCCESS",V="START_AUTHORIZATION",H="LOADING_DONE",q=function(){return function(e){var t=new URL(window.location.href).searchParams.get("code");e({type:_,payload:t})}},B=function(){return function(e,t){var a=t().code;return R.a.get("http://localhost:2025/getcredentials?code=".concat(a)).then((function(e){localStorage.setItem("token",e.data.accessToken)}))}},F=a(111),Y=a(24),J=function(e){return Object(r.useCallback)(function(){var t=Object(k.a)(f.a.mark((function t(a){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.validate(a,{abortEarly:!1});case 3:return r=t.sent,t.abrupt("return",{values:r,errors:{}});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{values:{},errors:t.t0.inner.reduce((function(e,t){var a;return Object(l.a)(Object(l.a)({},e),{},Object(Y.a)({},t.path,{type:null!==(a=t.type)&&void 0!==a?a:"validation",message:t.message}))}),{})});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),[e])},K=function(e){var t=Object(r.useState)(e),a=Object(g.a)(t,2),n=a[0],c=a[1];return{value:n,setValue:c,bind:{onChange:function(e,t){c(t)}}}},Z=a(121),W=a(2),X=Object(O.b)((function(e){return{authUri:e.authUri,success:e.success,playlistUrl:e.playlistUrl,active:e.active,playlistName:e.playlistName,alertMessage:e.alertMessage,variant:e.variant,token:e.token,isLoading:e.isLoading}}),{generatePlaylists:function(e){return function(t){t((function(e){return R.a.get("http://localhost:2025/me").then((function(t){e({type:z,payload:{alertMessage:"One moment...",variant:"warning"}}),e({type:C,payload:t.data.id}),e({type:U})}))})).then((function(){return t(function(e){return function(t){return t({type:N,payload:e})}}(e.formValues))})).then((function(){return t(function(e){return function(t,a){var r=a().playlistName;return t({type:z,payload:{alertMessage:'Now loading "'.concat(r,'"... '),variant:"warning"}}),t({type:T,payload:e})}}(e.sliderValue))})).then((function(){return t((function(e,t){var a=t(),r=a.userId,n=a.playlistName,c=a.description,l=a.privacy;return R.a.post("https://api.spotify.com/v1/users/".concat(r,"/playlists"),{name:n,description:c,public:l.toString()},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(t){e({type:w,payload:t.data.id}),e({type:M,payload:t.data.external_urls.spotify})}))}))})).then((function(){return t((function(e,t){var a,r,n,c=t(),l=c.genre,i=c.finalSliderValue,o=c.numSongs,s=0,u=7,d=[];n=o<=50?o:50,Object(k.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(s<=o&&u>0)){t.next=9;break}return r=Math.floor(10*Math.random()+1),a=E[Math.floor(Math.random()*E.length)],t.next=5,R.a.get("https://api.spotify.com/v1/search?query=".concat(a,"*+genre%3A").concat(l,"+year%3A+").concat(i[0],"-").concat(i[1],"&type=track&offset=").concat(r,"&limit=").concat(n),{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){d=[].concat(Object(m.a)(d),Object(m.a)(e.data.tracks.items));var t=new Map;d.forEach((function(e){var a=e.artists[0].name||"Unknown",r=t.get(a)||0;t.set(a,++r)}));var a=Object(m.a)(t).filter((function(e){var t=Object(g.a)(e,2);return t[0],t[1]<=2}));(d=d.filter((function(e){return a.flat().includes(e.artists[0].name)}))).length>o&&(d=d.splice(0,o)),s=d.length}));case 5:t.sent,u-=1,t.next=0;break;case 9:e({type:A,payload:d}),e({type:z,payload:{alertMessage:"Retrieving your tunes...",variant:"warning"}});case 11:case"end":return t.stop()}}),t)})))()}))})).then((function(){return t((function(e,t){var a=t().searchResults,r=[];return a.map((function(e){return r.push(e.uri)})),e({type:L,payload:r})}))})).then((function(){return t((function(e,t){var a=t(),r=a.playlistId,n=a.trackUris;return R.a.post("https://api.spotify.com/v1/playlists/".concat(r,"/tracks"),{uris:n},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(){e({type:G}),e({type:P})})).catch((function(){e({type:z,payload:{alertMessage:"An error has occurred \ud83d\ude25. Please refresh and try again.",variant:"danger"}})}))}))}))}},initialAuthorize:function(e){return function(t){e.preventDefault(),t({type:V}),t((function(e){return e({type:D}),R.a.get("http://localhost:2025/authorize").then((function(t){var a=new Date;console.log(a),localStorage.setItem("validated",a),e({type:I,payload:t.data})}))})).then((function(){return t((function(e,t){var a=t().authUri;return e({type:H}),window.location.href=a}))}))}},handleToken:B,retrieveCodeFromURL:q,getToken:function(){return function(e){e(q()).then((function(){return e(B())}))}}})((function(e){var t=e.generatePlaylists,a=e.playlistUrl,n=e.success,c=e.active,i=e.alertMessage,o=e.variant,h=e.initialAuthorize,O=e.handleToken,y=e.retrieveCodeFromURL,f=e.isLoading,g=J(x),m=Object(F.a)({resolver:g,mode:"onChange"}),k=m.register,S=m.handleSubmit,R=m.formState,E=K([1970,2e3]),I=E.value,C=E.bind;Object(r.useEffect)((function(){y(),O()}),[]);return Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(p.a,{className:"homepage-container",children:[Object(W.jsx)(p.a,{className:"title",children:Object(W.jsx)("h1",{children:"Spotify Playlist Generator \ud83c\udfa7"})}),!localStorage.getItem("validated")&&Object(W.jsxs)(p.a,{className:"disclaimer",children:[Object(W.jsx)("h2",{children:"In order to use this application, you must authorize your Spotify account."}),f?Object(W.jsx)(Z.a,{color:"black"}):Object(W.jsx)("button",{onClick:h,"data-testid":"auth-button",children:"I agree, authorize my account"})]}),localStorage.getItem("validated")&&Object(W.jsx)(p.a,{children:Object(W.jsxs)(u.a,{onSubmit:S((function(e){t({formValues:e,sliderValue:I})})),children:[Object(W.jsx)(u.a.Row,{className:"desktop",children:Object(W.jsx)(d.a,{children:Object(W.jsxs)(u.a.Group,{children:[Object(W.jsx)(u.a.Label,{children:"PLAYLIST NAME"}),Object(W.jsx)(u.a.Control,Object(l.a)(Object(l.a)({size:"lg",type:"text",placeholder:'"My Awesome New Playlist"'},k("playlistName",{required:!0})),{},{autoComplete:"off"}))]})})}),Object(W.jsxs)(u.a.Row,{children:[Object(W.jsx)(d.a,{xs:5,children:Object(W.jsxs)(u.a.Group,{children:[Object(W.jsx)(u.a.Label,{children:"MAX # OF SONGS"}),Object(W.jsx)(u.a.Control,Object(l.a)(Object(l.a)({},k("numSongs",{required:!0})),{},{type:"number",min:5,max:150,size:"lg",autoComplete:"off"}))]})}),Object(W.jsx)(d.a,{children:Object(W.jsxs)(u.a.Group,{children:[Object(W.jsx)(u.a.Label,{children:"PRIVATE/PUBLIC"}),Object(W.jsx)(u.a.Check,Object(l.a)(Object(l.a)({},k("privacy",{required:!0})),{},{type:"switch",id:"custom-switch"}))]})})]}),Object(W.jsx)(u.a.Row,{children:Object(W.jsx)(d.a,{children:Object(W.jsxs)(u.a.Group,{children:[Object(W.jsx)(u.a.Label,{children:"DESCRIPTION"}),Object(W.jsx)(u.a.Control,Object(l.a)(Object(l.a)({},k("description",{required:!0})),{},{rows:3,as:"textarea",maxLength:"250",autoComplete:"off"}))]})})}),Object(W.jsx)(u.a.Row,{children:Object(W.jsxs)(d.a,{children:[Object(W.jsx)(u.a.Label,{children:"YEAR RANGE"}),Object(W.jsx)(s,Object(l.a)(Object(l.a)({valueLabelDisplay:"auto",min:1950,max:2022,name:"year",value:I},C),{},{"aria-labelledby":"range-slider"}))]})}),Object(W.jsx)(u.a.Row,{children:Object(W.jsx)(d.a,{children:Object(W.jsxs)(u.a.Group,{children:[Object(W.jsx)(u.a.Label,{children:"GENRE"}),Object(W.jsx)(u.a.Control,Object(l.a)(Object(l.a)({},k("genre")),{},{as:"select",children:j.map((function(e,t){return Object(r.createElement)("option",Object(l.a)(Object(l.a)({},e.attributes),{},{value:e.value,key:t}),e.text)}))}))]})})}),Object(W.jsx)(u.a.Row,{children:Object(W.jsx)(d.a,{children:Object(W.jsx)(u.a.Group,{children:Object(W.jsx)(b.a,{disabled:!R.isValid,type:"submit",children:"Generate Playlist"})})})}),Object(W.jsx)(u.a.Row,{children:Object(W.jsxs)(d.a,{children:[c&&Object(W.jsx)(v.a,{variant:o,children:i}),Object(W.jsxs)(v.a,{variant:"success",style:{visibility:n?"visible":"hidden"},children:["Your playlist has successfully been created. You may view it"," ",Object(W.jsx)(v.a.Link,{href:a,children:"here"}),"."]})]})})]})})]})})}));var $=function(){return Object(W.jsx)(W.Fragment,{children:Object(W.jsx)(X,{})})},Q=a(76),ee={authUri:"",userId:"",playlistId:"",searchResults:[],trackUris:[],playlistName:"",description:"",privacy:!1,genre:"",numSongs:"",finalSliderValue:[],snapShotId:"",playlistUrl:"",alertMessage:"",variant:"",success:!1,active:!1,code:"",authMessage:"",promiseError:!1,isLoading:!1};var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(l.a)(Object(l.a)({},e),{},{authUri:t.payload,authMessage:t.payload});case C:return Object(l.a)(Object(l.a)({},e),{},{userId:t.payload});case N:return Object(l.a)(Object(l.a)({},e),{},{playlistName:t.payload.playlistName,description:t.payload.description,privacy:t.payload.privacy,genre:t.payload.genre,numSongs:t.payload.numSongs});case T:return Object(l.a)(Object(l.a)({},e),{},{finalSliderValue:t.payload});case w:return Object(l.a)(Object(l.a)({},e),{},{playlistId:t.payload});case A:return Object(l.a)(Object(l.a)({},e),{},{searchResults:t.payload});case L:return Object(l.a)(Object(l.a)({},e),{},{trackUris:t.payload});case M:return Object(l.a)(Object(l.a)({},e),{},{playlistUrl:t.payload});case P:return Object(l.a)(Object(l.a)({},e),{},{success:!0});case U:return Object(l.a)(Object(l.a)({},e),{},{active:!0});case z:return Object(l.a)(Object(l.a)({},e),{},{alertMessage:t.payload.alertMessage,variant:t.payload.variant});case G:return Object(l.a)(Object(l.a)({},e),{},{active:!1});case D:return Object(l.a)(Object(l.a)({},e),{},{success:!1});case _:return Object(l.a)(Object(l.a)({},e),{},{code:t.payload});case V:return Object(l.a)(Object(l.a)({},e),{},{isLoading:!0});case H:return Object(l.a)(Object(l.a)({},e),{},{isLoading:!1});default:return e}},ae=a(120),re=Object(Q.b)(te,Object(Q.a)(ae.a));c.a.render(Object(W.jsx)(O.a,{store:re,children:Object(W.jsx)($,{})}),document.getElementById("root"))}},[[252,1,2]]]);
//# sourceMappingURL=main.8f1431cb.chunk.js.map